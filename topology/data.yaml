nodes:
  - name: n1
    role: host
    mgmt_ip: 172.20.20.8
    bgp:
      asn: 65001
      router_id: 1.1.1.1
    interfaces:
      - { name: n1-eth1, ipv4_address: "192.168.1.2", ipv4_mask: /30 }

  - name: n2
    role: host
    mgmt_ip: 172.20.20.9
    bgp:
      asn: 65002
      router_id: 2.2.2.2
    interfaces:
      - { name: n2-eth2, ipv4_address: "192.168.2.2", ipv4_mask: /30 }

  - name: ce1
    role: ce
    mgmt_ip: 172.20.20.11
    bgp:
      asn: 65001
      router_id: 10.0.0.1
    interfaces:
      - { name: ce1-eth10, ipv4_address: "192.168.1.1", ipv4_mask: /30 }
      - { name: ce1-eth1, ipv4_address: "10.1.1.0", ipv4_mask: /31 }
      - { name: ce1-eth2, ipv4_address: "10.1.1.2", ipv4_mask: /31 }

  - name: ce2
    role: ce
    mgmt_ip: 172.20.20.12
    bgp:
      asn: 65002
      router_id: 10.0.0.2
    interfaces:
      - { name: ce2-eth10, ipv4_address: "192.168.2.1", ipv4_mask: /30 }
      - { name: ce2-eth1, ipv4_address: "10.1.2.0", ipv4_mask: /31 }
      - { name: ce2-eth2, ipv4_address: "10.1.2.2", ipv4_mask: /31 }

  - name: pe1
    role: pe
    mgmt_ip: 172.20.20.13
    bgp:
      asn: 65000
      router_id: 10.0.0.11
    interfaces:
      - { name: pe1-eth1, ipv4_address: "10.1.1.1", ipv4_mask: /31 }
      - { name: pe1-eth2, ipv4_address: "10.1.2.1", ipv4_mask: /31 }
      - { name: pe1-eth3, ipv4_address: "10.2.0.11", ipv4_mask: /24 }

  - name: pe2
    role: pe
    mgmt_ip: 172.20.20.14
    bgp:
      asn: 65000
      router_id: 10.0.0.12
    interfaces:
      - { name: pe2-eth1, ipv4_address: "10.1.1.3", ipv4_mask: /31 }  
      - { name: pe2-eth2, ipv4_address: "10.1.2.3", ipv4_mask: /31 }
      - { name: p2-eth3,  ipv4_address: "10.2.0.12", ipv4_mask: /24 }

  - name: gw1
    role: gw
    mgmt_ip: 172.20.20.15
    bgp:
      asn: 65000
      router_id: 10.0.0.21
    interfaces:
      - { name: gw1-eth3, ipv4_address: "10.2.0.21", ipv4_mask: /24 }
      - { name: gw1-eth4, ipv4_address: "10.3.1.0", ipv4_mask: /31 }

  - name: gw2
    role: gw
    mgmt_ip: 172.20.20.16
    bgp:
      asn: 65000
      router_id: 10.0.0.22
    interfaces:
      - { name: gw2-eth3, ipv4_address: "10.2.0.22", ipv4_mask: /24 }
      - { name: gw2-eth4, ipv4_address: "10.3.2.0", ipv4_mask: /31 } 

  - name: up1
    role: up
    mgmt_ip: 172.20.20.17
    bgp:
      asn: 65100
      router_id: 10.0.0.31
    interfaces:
      - { name: up1-eth1, ipv4_address: "10.3.1.1", ipv4_mask: /31 }
      - { name: up1-eth10, ipv4_address: "10.4.1.0", ipv4_mask: /31 }

  - name: up2
    role: up
    mgmt_ip: 172.20.20.18
    bgp:
      asn: 65200
      router_id: 10.0.0.32
    interfaces:
      - { name: up2-eth1, ipv4_address: "10.3.2.1", ipv4_mask: /31 }
      - { name: up2-eth10, ipv4_address: "10.4.2.0", ipv4_mask: /31 }

  # internet
  - name: n3
    role: host
    mgmt_ip: 172.20.20.10
    bgp:
      asn: 65500
      router_id: 8.8.8.8
    interfaces:
      - { name: n3-eth1, ipv4_address: "10.4.1.1", ipv4_mask: /31 }
      - { name: n3-eth2, ipv4_address: "10.4.2.1", ipv4_mask: /31 }

  - name: lan
    role: bridge
    kind: bridge

links:
  - { a: "n1", a_port: "n1-eth1", b: "ce1", b_port: "ce1-eth10" }
  - { a: "n2", a_port: "n2-eth2", b: "ce2", b_port: "ce2-eth10" }

  - { a: "ce1", a_port: "ce1-eth1", b: "pe1", b_port: "pe1-eth1" }
  - { a: "ce1", a_port: "ce1-eth2", b: "pe2", b_port: "pe2-eth1" }
  - { a: "ce2", a_port: "ce2-eth1", b: "pe1", b_port: "pe1-eth2" }
  - { a: "ce2", a_port: "ce2-eth2", b: "pe2", b_port: "pe2-eth2" }

  - { a: "pe1", a_port: "pe1-eth3", b: "lan", b_port: "lan-eth1" }
  - { a: "pe2", a_port: "p2-eth3", b: "lan", b_port: "lan-eth2" }
  - { a: "gw1", a_port: "gw1-eth3", b: "lan", b_port: "lan-eth3" }
  - { a: "gw2", a_port: "gw2-eth3", b: "lan", b_port: "lan-eth4" }

  - { a: "gw1", a_port: "gw1-eth4", b: "up1", b_port: "up1-eth1" }
  - { a: "gw2", a_port: "gw2-eth4", b: "up2", b_port: "up2-eth1" }

  - { a: "up1", a_port: "up1-eth10", b: "n3", b_port: "n3-eth1" }
  - { a: "up2", a_port: "up2-eth10", b: "n3", b_port: "n3-eth2" }