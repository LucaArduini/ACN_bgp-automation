name: project

topology:
    nodes:
      
      n1:
        
        kind: linux
        
        
        
        image: alpine:latest 
        env: 
          MY_INTF: eth1
          MY_IP: 198.51.100.3/24
          MY_GW: 198.51.100.1
        binds:  
        - ./configs/linux-host-cfg.sh:/linux-cfg.sh
        exec: 
          - echo "script on n1"
          - sh /linux-cfg.sh 
        
        
      
      n2:
        
        kind: linux
        
        
        
        image: alpine:latest 
        env: 
          MY_INTF: eth1
          MY_IP: 192.0.2.0/24
          MY_GW: 192.0.2.1
        binds:  
        - ./configs/linux-host-cfg.sh:/linux-cfg.sh
        exec: 
          - echo "script on n2"
          - sh /linux-cfg.sh 
        
        
      
      ce1:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/ce1.conf
        binds:
          - ./configs/ce1.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      ce2:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/ce2.conf
        binds:
          - ./configs/ce2.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      pe1:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/pe1.conf
        binds:
          - ./configs/pe1.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      pe2:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/pe2.conf
        binds:
          - ./configs/pe2.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      gw1:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/gw1.conf
        binds:
          - ./configs/gw1.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      gw2:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/gw2.conf
        binds:
          - ./configs/gw2.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      up1:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/up1.conf
        binds:
          - ./configs/up1.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      up2:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/up2.conf
        binds:
          - ./configs/up2.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      r3:
        
        kind: linux
        
        
        
        image: quay.io/frrouting/frr:10.4.1
        startup-config: configs/r3.conf
        binds:
          - ./configs/r3.conf:/etc/frr/frr.conf
          - ./configs/frr/daemons:/etc/frr/daemons
          - ./configs/frr/vtysh.conf:/etc/frr/vtysh.conf
          - ./configs/frr/frr-cfg.sh:/frr-cfg.sh
        
        
      
      lan:
        
        kind: bridge
        
        
      

    links:
      
          - endpoints: ["n1:eth1", "ce1:eth3"]
      
          - endpoints: ["n2:eth1", "ce2:eth10"]
      
          - endpoints: ["ce1:eth1", "pe1:eth1"]
      
          - endpoints: ["ce1:eth2", "pe2:eth1"]
      
          - endpoints: ["ce2:eth1", "pe1:eth3"]
      
          - endpoints: ["ce2:eth2", "pe2:eth3"]
      
          - endpoints: ["pe1:eth4", "lan:eth1"]
      
          - endpoints: ["pe2:eth4", "lan:eth2"]
      
          - endpoints: ["gw1:eth3", "lan:eth3"]
      
          - endpoints: ["gw2:eth3", "lan:eth4"]
      
          - endpoints: ["gw1:eth2", "up1:eth1"]
      
          - endpoints: ["gw2:eth2", "up2:eth1"]
      
          - endpoints: ["up1:eth2", "r3:eth1"]
      
          - endpoints: ["up2:eth2", "r3:eth2"]
      

      
        
      
        
      
        
          - type: dummy
            endpoint:
              node: ce1
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: ce2
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: pe1
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: pe2
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: gw1
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: gw2
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: up1
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: up2
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: r3
              interface: l0
        
      
        
          - type: dummy
            endpoint:
              node: lan
              interface: l0
        
      